export default class Stack{static isInitialized=!1;static defaultSelector="";static defaults={};static registry=[];static get totalInstances(){return this.registry.length}id;layout;justify;transition;duration;easing;rows;cols;minRows;minCols;align;autoplay;pages;element;#pageWidth;#pagesContainer;#controlElement;#navigationElement;#indicatorElement;#externalControlElements;#externalNavigationElements;#externalIndicatorElements;get#pageItemNum(){return this.rows*this.cols}get size(){return{width:this.element.getBoundingClientRect().width,height:this.element.getBoundingClientRect().height}}set activeIndex(t){this.element.dataset.active=t}get activeIndex(){return parseInt(this.element.dataset.active)}static init(t=null,e=null){this.initDefaults();for(var i of document.querySelectorAll(t||this.defaultSelector))this.register(new this(this.totalInstances,i,e));this.isInitialized=!0}static initDefaults(){this.defaultSelector='[data-component="stack"]',this.defaults.id="stack-",this.defaults.layout="list",this.defaults.justify="start",this.defaults.transition="slide",this.defaults.duration=300,this.defaults.easing="ease-out",this.defaults.rows=1,this.defaults.cols=1,this.defaults.minRows=1,this.defaults.minCols=1,this.defaults.align="start",this.defaults.autoplay=0,this.defaults.activeIndex=0}static register(t){this.registry.push(t)}constructor(t,e,i=null){var s=this.constructor,i=i||e.dataset;this.element=e,this.pages=[],this.id=e.id||s.defaults.id+s.totalInstances,this.layout=i.layout||s.defaults.layout,this.justify=i.justify||s.defaults.justify,this.transition=i.transition||s.defaults.transition,this.duration=i.duration||s.defaults.duration,this.easing=i.easing||s.defaults.easing,this.activeIndex=i.active||s.defaults.activeIndex,this.rows=i.rows?parseInt(i.rows):s.defaults.rows,this.cols=i.cols?parseInt(i.cols):s.defaults.cols,this.minRows=i.minRows?parseInt(i.minRows):s.defaults.minRows,this.minCols=i.minCols?parseInt(i.minCols):s.defaults.minCols,this.align=i.align||s.defaults.align,this.autoplay=i.autoplay||s.defaults.autoplay,this.element.id=this.id,this.configure()}configure(){this.initPages(),this.initControls(),this.initExternalControls()}initPages(){var t,e;this.#pagesContainer||((t=this.element.querySelector(".pages"))?this.#pagesContainer=t:(this.#pagesContainer=document.createElement("div"),this.#pagesContainer.classList.add("pages"),this.element.appendChild(this.#pagesContainer))),this.#pagesContainer.innerHTML="";let i=0,s=0;for(e of this.element.querySelectorAll(".item")){var a=e.dataset.colspan?parseInt(e.dataset.colspan):1;if(s+a>this.cols&&(i++,s=0),!this.pages[i]){let t=document.createElement("div");t.classList.add("page"),i===this.activeIndex&&t.classList.add("active"),this.#pagesContainer.appendChild(t),this.pages.push(t)}this.pages[i].appendChild(e),s+=this.cols}this.#pageWidth||(this.#pageWidth=this.pages[0].getBoundingClientRect().width);for(let e=0;e<this.pages.length;e++){let t=this.pages[e];var n=this.calculatePagePosition(e);t.style.transform=`translate3d(${n.x}px, ${n.y}px, ${n.z}px)`,t.style.zIndex=this.calculatePageZIndex(e)}if("stack"===this.layout)for(var l=0;l<this.pages.length;l++){let t=this.pages[l],e=l,i=t.querySelector(".item"),s=t.querySelector(".overlay-nav");s||(s=document.createElement("div"),s.classList.add("overlay-nav"),i&&i.appendChild(s)),s.addEventListener("click",()=>{this.goToPage(e)})}}calculatePagePosition(t){this.pages[t];let e=0,i=0;let s=0;return"center"===this.align&&(e=(this.size.width-this.#pageWidth)/2),"list"===this.layout?i=e+(t-this.activeIndex)*this.#pageWidth:"stack"===this.layout&&(i=e+(t-this.activeIndex)*this.#pageWidth-240*(t-this.activeIndex),s=-1*Math.abs(50*(t-this.activeIndex))),{x:i,y:0,z:s}}calculatePageZIndex(t){return t===this.activeIndex?7001:7e3-Math.abs(t-this.activeIndex)}initControls(){var t,e;this.#controlElement||((t=this.element.querySelector(".control"))?this.#controlElement=t:(this.#controlElement=document.createElement("div"),this.#controlElement.classList.add("control"),this.element.appendChild(this.#controlElement))),this.#indicatorElement||((e=this.element.querySelector(".indicator"))?this.#indicatorElement=e:(this.#indicatorElement=document.createElement("div"),this.#indicatorElement.classList.add("indicator"),this.#controlElement.appendChild(this.#indicatorElement))),this.#navigationElement||((e=this.element.querySelector(".navigation"))?this.#navigationElement=e:(this.#navigationElement=document.createElement("div"),this.#navigationElement.classList.add("navigation"),this.#controlElement.appendChild(this.#navigationElement))),this.#indicatorElement.innerHTML="";for(let e=0;e<this.pages.length;e++){let t=document.createElement("button");t.dataset.target=e,e===this.activeIndex&&t.classList.add("active"),t.addEventListener("click",()=>{this.goToPage(e)}),this.#indicatorElement.appendChild(t)}this.#navigationElement.innerHTML="";let i=document.createElement("button");i.dataset.nav="prev",this.#navigationElement.appendChild(i),i.addEventListener("click",()=>{this.goToPage(this.activeIndex-1,-1)});let s=document.createElement("button");s.dataset.nav="next",this.#navigationElement.appendChild(s),s.addEventListener("click",()=>{this.goToPage(this.activeIndex+1,-1)})}initExternalControls(){this.#externalIndicatorElements||(this.#externalIndicatorElements=document.querySelectorAll(`[data-indicator="${this.id}"]`));for(var t=0;t<this.#externalIndicatorElements.length;t++){let i=this.#externalIndicatorElements[t];i.innerHTML="",this.#indicatorElement.innerHTML="";for(let e=0;e<this.pages.length;e++){let t=document.createElement("button");t.dataset.target=e,e===this.activeIndex&&t.classList.add("active"),t.addEventListener("click",()=>{this.goToPage(e)}),i.appendChild(t)}}}goToPage(t,e=1){let i=t;t<0?i=this.pages.length-1:t>=this.pages.length&&(i=0);t=this.activeIndex;this.pages[i]&&(this.activeIndex=i,this.updateIndicators(),this.updateExternalIndicators(),this.updatePages(t,i,e))}updateIndicators(){var i=this.#indicatorElement.querySelectorAll("button");for(let e=0;e<i.length;e++){let t=i[e];t.classList.remove("active"),e===this.activeIndex&&t.classList.add("active")}}updateExternalIndicators(){if(this.#externalIndicatorElements)for(var t of this.#externalIndicatorElements){var i=t.querySelectorAll("button");for(let e=0;e<i.length;e++){let t=i[e];t.classList.remove("active"),e===this.activeIndex&&t.classList.add("active")}}}updatePages(t,i,e=0){for(let e=0;e<this.pages.length;e++){let t=this.pages[e];var s=this.calculatePagePosition(e),s=`translate3d(${s.x}px, ${s.y}px, ${s.z}px)`;t.classList.remove("active"),e===i&&t.classList.add("active"),"slide"===this.transition&&t.animate([{transform:t.style.transform},{transform:s}],{duration:this.duration,easing:this.easing}),t.style.transform=s,t.style.zIndex=this.calculatePageZIndex(e)}}}window&&(window.Stack=Stack);