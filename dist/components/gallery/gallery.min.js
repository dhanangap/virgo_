class Gallery{static selector;static index;static externalIndicators;static externalNavigations;element;id;cols;rows;transition;duration;modal;activePageIndex;items;pages;pagesElement;controlElement;indicatorElement;navigationElement;navlock;scrollAmount;isScrolling;externalIndicators;externalNavigations;get totalPages(){return Math.ceil(this.items.length/this.numPageItems)}get numPageItems(){return this.cols*this.rows}static init(){this.selector=".gallery",this.index=[],this.externalIndicators={},this.externalNavigations={};var e=document.querySelectorAll(this.selector);if(console.log(e.length),0<e.length){for(let t=0;t<e.length;t++){var i=e[t];this.index.push(new this(t,i))}window.addEventListener("resize",()=>{this.resizeListener()})}this.initExternalIndicators(),this.initExternalNavigations()}static resizeListener(){for(const t of this.index)t.resize()}static initExternalIndicators(){for(const t of document.querySelectorAll("[data-gallery-indicator]")){const e=t.dataset.galleryIndicator,i=this.index.find(t=>t.id===e);i&&(this.externalIndicators[e]||(this.externalIndicators[e]=[]),this.externalIndicators[e].push(t),i.initExternalIndicators())}}static initExternalNavigations(){for(const i of document.querySelectorAll("[data-gallery-navigation]")){const s=i.dataset.galleryNavigation,a=this.index.find(t=>t.id===s);if(a){this.externalNavigations[s]||(this.externalNavigations[s]=[]),this.externalNavigations[s].push(i);let t=i.querySelector('[data-navigation="prev"]'),e=i.querySelector('[data-navigation="next"]');t&&t.addEventListener("click",()=>{a.back()}),e&&e.addEventListener("click",()=>{a.forward()})}}}constructor(t,e){this.element=e,this.id=e.id||"gallery-"+t,e.id=this.id,this.cols=e.dataset.cols?parseInt(e.dataset.cols):1,this.rows=e.dataset.rows?parseInt(e.dataset.rows):1,this.transition=e.dataset.transition||"default",this.duration=e.dataset.duration?parseInt(e.dataset.duration):500,this.modal=e.dataset.modal||null,this.activePageIndex=e.dataset.active?parseInt(e.dataset.active):0,this.items=e.querySelectorAll(".item"),this.pages=[],this.navlock=!1,this.scrollAmount=0,this.resize(),this.initEventListeners()}initPages(){this.pagesElement||(this.pagesElement=document.createElement("div"),this.pagesElement.classList.add("pages"),this.element.appendChild(this.pagesElement)),this.pages=[],this.pagesElement.innerHTML="";for(let e=0;e<this.totalPages;e++){let t=document.createElement("div");t.classList.add("page"),e===this.activePageIndex&&t.classList.add("active"),this.pagesElement.appendChild(t),this.pages.push(t)}for(let e=0;e<this.items.length;e++){var i=Math.floor(e/this.numPageItems);let t=this.items[e];this.pages[i].appendChild(t),t.style.width=1/this.cols*100+"%",t.style.height=1/this.rows*100+"%",t.addEventListener("click",()=>{t.dataset.click&&""!==t.dataset.click?this.customClickEvent(t):this.defaultClickEvent(t)})}}initControlElement(){this.controlElement||(this.controlElement=document.createElement("div"),this.controlElement.classList.add("control"),this.element.appendChild(this.controlElement))}initIndicator(){this.indicatorElement||(this.indicatorElement=document.createElement("div"),this.indicatorElement.classList.add("indicator"),this.controlElement.appendChild(this.indicatorElement)),this.indicatorElement.innerHTML="";for(let e=0;e<this.totalPages;e++){let t=document.createElement("button");t.dataset.target=e,e===this.activePageIndex&&t.classList.add("active"),this.indicatorElement.appendChild(t),t.addEventListener("click",()=>{this.setActivePage(e)})}}initExternalIndicators(){if(Gallery.externalIndicators[this.id])for(var i of Gallery.externalIndicators[this.id]){i.innerHTML="";for(let e=0;e<this.totalPages;e++){let t=document.createElement("button");t.dataset.target=e,e===this.activePageIndex&&t.classList.add("active"),i.appendChild(t),t.addEventListener("click",()=>{this.setActivePage(e)})}}}initNavigation(){this.navigationElement||(this.navigationElement=document.createElement("div"),this.navigationElement.classList.add("navigation"),this.controlElement.appendChild(this.navigationElement)),this.navigationElement.innerHTML="";let t=document.createElement("button");t.classList.add("prev"),this.navigationElement.appendChild(t),t.addEventListener("click",()=>{this.back()});let e=document.createElement("button");e.classList.add("next"),e.addEventListener("click",()=>{this.forward()}),this.navigationElement.appendChild(e)}initEventListeners(){this.element.addEventListener("wheel",t=>{0<Math.abs(t.deltaX)&&(t.preventDefault(),this.scroll(t.deltaX))}),this.element.addEventListener("touchstart",t=>{let i=t.touches[0].clientX;const e=t=>{var e=i-t.touches[0].clientX;this.scroll(e),i=t.touches[0].clientX},s=()=>{this.element.removeEventListener("touchmove",e),this.element.removeEventListener("touchend",s)};this.element.addEventListener("touchmove",e),this.element.addEventListener("touchend",s)})}resize(){this.element.getBoundingClientRect().width<=450?this.cols=Math.min(this.cols,2):this.cols=this.element.dataset.cols?parseInt(this.element.dataset.cols):1,0<this.items.length&&(this.initPages(),this.initControlElement(),this.initIndicator(),this.initNavigation(),this.initExternalIndicators())}setActivePage(t,e=null){var i,s;this.navlock||(i=this.pages[this.activePageIndex],s=this.pages[t],e=e||(t-this.activePageIndex)/Math.abs(t-this.activePageIndex),s&&(this.activePageIndex=t,this.navlock=!0,this.updateIndicator(),this.updatePages(i,s,e),setTimeout(()=>{this.navlock=!1},this.duration+500)))}updateIndicator(){if(this.indicatorElement){var i=this.indicatorElement.querySelectorAll("button");for(let e=0;e<i.length;e++){let t=i[e];t.classList.remove("active"),e===this.activePageIndex&&t.classList.add("active")}}if(Gallery.externalIndicators[this.id])for(const t of Gallery.externalIndicators[this.id]){var s=t.querySelectorAll("button");for(let e=0;e<s.length;e++){let t=s[e];t.classList.remove("active"),e===this.activePageIndex&&t.classList.add("active")}}}updatePages(t,e,i=1){if(this.pages){"none"!==this.transition&&("slide"!==this.transition&&"default"!==this.transition||(""===t.style.transform&&(t.style.transform="translate3d(0, 0, 0)"),""===e.style.transform&&(e.style.transform=`translate3d(${100*i}%, 0, 0)`),t.animate([{transform:t.style.transform},{transform:`translate3d(${-100*i}%, 0, 0)`}],{duration:this.duration,easing:"ease-out"}),e.animate([{transform:e.style.transform},{transform:"translate3d(0, 0, 0)"}],{duration:this.duration,easing:"ease-out"}),setTimeout(()=>{t.style.transform="",e.style.transform="translate3d(0, 0, 0)"},300)));for(let e=0;e<this.pages.length;e++){let t=this.pages[e];t.classList.remove("active"),e===this.activePageIndex&&t.classList.add("active")}}}back(){let t=this.activePageIndex-1;t<0&&(t=this.totalPages-1),this.setActivePage(t,-1)}forward(){let t=this.activePageIndex+1;t>=this.totalPages&&(t=0),this.setActivePage(t,1)}scroll(i){const s=this.element.getBoundingClientRect().width;if(!this.navlock){this.isScrolling&&window.clearTimeout(this.isScrolling),this.scrollAmount-=i,Math.abs(this.scrollAmount)>s&&(this.scrollAmount=Math.sign(this.scrollAmount)*s);let t=this.pages[this.activePageIndex],e;0<i?(e=this.activePageIndex+1<this.pages.length?this.pages[this.activePageIndex+1]:this.pages[0],e.style.transform=`translate3d(calc(100% + ${this.scrollAmount}px), 0, 0)`):(e=this.activePageIndex-1<0?this.pages[this.pages.length-1]:this.pages[this.activePageIndex-1],e.style.transform=`translate3d(calc(${this.scrollAmount}px - 100%), 0, 0)`),t.style.transform=`translate3d(${this.scrollAmount}px, 0, 0)`,this.isScrolling=setTimeout(()=>{this.navlock=!0,this.scrollAmount<=-.3*s?(this.navlock=!1,this.forward()):this.scrollAmount>=.3*s?(this.navlock=!1,this.back()):(t.animate([{transform:t.style.transform},{transform:"translate3d(0, 0, 0)"}],{duration:this.duration,easing:"ease-out"}),t.style.transform="translate3d(0, 0, 0)",0<i?e.animate([{transform:e.style.transform},{transform:"translate3d(100%, 0, 0)"}],{duration:this.duration,easing:"ease-out"}):e.animate([{transform:e.style.transform},{transform:"translate3d(-100%, 0, 0)"}],{duration:this.duration,easing:"ease-out"}),e.style.transform="",this.navlock=!1),this.scrollAmount=0},50)}}customClickEvent(t){var e=t.dataset.click;if(e){const i=window[e];i&&i({galleryId:this.id,itemData:Object.assign({},t.dataset),trigger:t})}}defaultClickEvent(t){this.modal}}window&&(window.Gallery=Gallery);export{Gallery};